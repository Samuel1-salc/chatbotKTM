<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Automação de WhatsApp Dinâmica</title>
</head>
<body>
    <h1>Automação de WhatsApp Dinâmica</h1>
    <textarea id="bar" placeholder="Digite o texto do menu"></textarea>
    <button id="addButton">Adicionar</button>
    <div id="camposAdicionados"></div>

    <script>
        let condicaoNumero = 1;
        const condicoes = [];

        // Função para criar uma nova condição de resposta
        function adicionarCondicao(numero, mensagem) {
            condicoes.push({
                numero: numero,
                acao: async (msg) => {
                    if (msg.body === String(numero) && msg.from.endsWith('@c.us')) {
                        const chat = await msg.getChat();
                        
                        await delay(2000); // atraso de 3 segundos
                        await chat.sendStateTyping(); // Simulando digitação
                        await delay(1000);
                        await client.sendMessage(msg.from, mensagem);
                        
                        await delay(2000); // atraso de 3 segundos
                        await chat.sendStateTyping(); // Simulando digitação
                        await delay(1000);
                        await client.sendMessage(msg.from, '5 - voltar para o menu');
                    }
                }
            });
        }

        // Função para adicionar uma nova área de texto e uma nova condição ao script
        function adicionarCampo() {
            const novoTexto = document.getElementById("bar").value;
            if (!novoTexto.trim()) return; // Não cria campo vazio

            condicaoNumero++; // Incrementa o número da condição

            // Adiciona uma nova condição de automação com o texto fornecido
            adicionarCondicao(condicaoNumero, novoTexto);

            // Exibe o texto em uma nova área para conferência
            const novaArea = document.createElement('textarea');
            novaArea.value = novoTexto;
            novaArea.placeholder = `Texto para a condição ${condicaoNumero}`;
            novaArea.readOnly = true;
            document.getElementById('camposAdicionados').appendChild(novaArea);

            // Limpa o campo de entrada
            document.getElementById("bar").value = "";
        }

        document.getElementById("addButton").addEventListener("click", adicionarCampo);

        // Função para processar uma mensagem recebida e verificar condições
        async function processarMensagem(msg) {
            for (const condicao of condicoes) {
                await condicao.acao(msg); // Executa a ação associada à condição se a condição for atendida
            }
        }

        // Exemplo de função delay para simular atraso
        function delay(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        // Exemplo de execução de mensagens
        // Aqui você chamaria processarMensagem(msg) onde msg é o objeto de mensagem recebido
    </script>
</body>
</html>
